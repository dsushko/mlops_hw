# MLOps homework
Добро пожаловать в домашнее задание по MLOps.\
В качестве задания предлагается следующее:
 - Изучить структуру проекта в этом репозитории
 - Настроить доступ к удаленной машине с использованием ssh ключа
 - Развернуть проект на удаленной машине
 - Доработать проект с использованием модели компьютерного зрения, разработанной вами в первом ДЗ
Далее перечислена подробная реализация шагов

## Настройка доступа ssh по ключу

1. Выяснить логин и пароль для подключения к машине у преподавателя
2. На локальной машине
```bash
ssh-keygen # если у вас нет файла ~/.ssh/id_rsa
ssh-copy-id ВАШ_ЮЗЕРНЕЙМ@АДРЕС_МАШИНЫ
```

## Развертывание 

1. Подключение к машине по ssh
```bash
ssh ВАШ_ЮЗЕРНЕЙМ@АДРЕС_МАШИНЫ
```
2. Скачивание репозитория на удаленной ВМ
```bash
cd ~
git clone https://github.com/Ingvar1997/students-mlops-boilerplate mlops_$(whoami)
cd mlops_$(whoami)
```
3. Настройка решения\
Вся конфигурация лежит в папке .env.template. Docker-compose использует файл .env, поэтому нужно сделать следующее.
```bash
cp .env.template .env
```
Затем вам следует с использованием любого удобного вам редактора (nano, vim, emacs) отредактировать файл .env указав внешний порт, согласованный с преподавателем, и адрес сервера.

1. Запуск
```bash
docker-compose up -d --build
```
5. Проверка\
Скрипт для проверки называется `tester.py`. Он считывает конфигурацию из .env и шлет http POST запрос на адрес, подобранный из конфигурации, с картинкой `test_im.jpg`, которую вы должны предварительно положить в корень проекта. Ту картинку, которая возвращается api он сохраняет под названием  responce.jpg.\
Запускать скрипт для проверки вы можете как на удаленной машине, так и локально, написав предварительно правильный .env файл, в котором в качестве `APPLICATION_EXTERNAL_URL` нужно будет указать IP адрес ВМ.


## Доработка

Вам следует внедрить в проект разработанную вами в домашнем задании по computer vision модель для сегментации изображения.\
Она должна быть внедрена в том месте, где написано `# DO SOME MANIPULATIONS HERE`.\
Вам следует сделать так, чтобы в api передавалось не только непосредственно изображение, но и число кластеров, на которое оно должно быть сегментировано через поле `n_segments` в посылаемом JSON. Api должно возвращать сегментированную картинку.\
Таким образом, результатом вашей работы должно стать API развернутое на заданном порту на заданной ВМ, которое будет сегментировать посылаемые на него по пути `v1.0/image/run-segmentation` картинки на заданное число сегментов.